select * from emp


DROP TABLE LOG_EMP

CREATE TABLE LOG_EMP(
    ID INTEGER DEFAULT (NEXTVAL('SEQ_LOG_EMP')),
    NAME_USER TEXT,
    ALT_VALUE_NAME TEXT,
    ALT_SALARIO_VALUE NUMERIC (10,2),
    ALT_DATA TIMESTAMP,
    
    CONSTRAINT PK_LOG_EMP PRIMARY KEY (ID)
);

SELECT * FROM LOG_EMP

CREATE SEQUENCE SEQ_LOG_EMP


CREATE OR REPLACE FUNCTION LOG_EMP()
    RETURNS TRIGGER AS 
$$
    BEGIN
        INSERT INTO LOG_EMP (NAME_USER, ALT_VALUE_NAME, ALT_SALARIO_VALUE, ALT_DATA)
            VALUES (CURRENT_USER, NEW.nome_emp, NEW.salario, NEW.ultima_data);
    RETURN NEW;
    END;
$$
LANGUAGE PLPGSQL;

CREATE TRIGGER TRIGGER_LOG_EMP BEFORE INSERT OR UPDATE ON EMP
    FOR EACH ROW EXECUTE PROCEDURE LOG_EMP();
    
 SELECT * FROM EMP
INSERT INTO EMP VALUES (1, 'TESTE PRIMEIRO', 1200.00, '2023-01-01', 'GARIBALTO')



SELECT * FROM LOG_EMP
